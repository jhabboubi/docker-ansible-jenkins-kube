---
- hosts: 127.0.0.1
  become: true
  tasks:
  - name: apt update
    command: apt update
  - name: apt install
    command: apt install software-properties-common
  - name: conntrack install
    command: apt install conntrack
  - name: Add an apt signing key for Kubernetes
    apt_key:
      url: https://packages.cloud.google.com/apt/doc/apt-key.gpg
      state: present
  - name: Adding apt repository for Kubernetes
    apt_repository:
      repo: deb https://apt.kubernetes.io/ kubernetes-xenial main
      state: present
      filename: kubernetes.list
  - name: Install Kubernetes binaries
    apt: 
      name: "{{ packages }}"
      state: present
    vars:
      packages:
        - kubeadm
        - kubectl
  - name: run Kubernetes
    command: kubectl apply -f Kubernetes.yaml 
